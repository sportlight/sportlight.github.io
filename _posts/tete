---
title: "[Special Report] 2025년 11월, 대한민국 보안의 붕괴 - 쿠팡과 업비트, 그리고 라자루스(Lazarus)의 그림자"
date: 2025-12-01 17:00:00 +0900
categories: [Security, Incident-Analysis]
tags: [lazarus, apt, bola, hot-wallet, mpc, zero-trust, solana, crypto-heist]
math: true
mermaid: true
---

## 1. 서론 (Executive Summary)

2025년 11월은 대한민국 IT 보안 역사상 가장 뼈아픈 시기로 기록될 것이다.
국내 이커머스 점유율 1위 **쿠팡(Coupang)**에서는 타인의 개인정보가 무방비로 노출되는 사고가 발생했고, 가상자산 거래소 1위 **업비트(Upbit)**에서는 약 455억 원 규모의 솔라나(Solana)가 탈취되었다.

두 사건은 서로 다른 도메인(Web 2.0 vs Web 3.0)에서 발생했으나, 그 이면에는 **"시스템의 속도와 편의성을 위해 보안 무결성을 타협했다"**는 공통된 원인이 존재한다. 또한, 업비트 사태의 배후로 지목되는 **북한 해킹 조직(Lazarus Group)**의 존재는 이 문제가 단순한 기술적 결함을 넘어선 '사이버 안보 위협'임을 시사한다.

본 리포트에서는 9년 차 엔지니어의 시각으로, 이번 연쇄 보안 사고의 **기술적 원인(Root Cause)**을 심층 해부하고, 위협 행위자(Threat Actor)의 공격 흐름을 재구성하여 근본적인 대응 전략을 제언한다.

---

## 2. 위협 인텔리전스: 공격자는 누구인가?

이번 사태를 이해하기 위해서는 2025년 초 발생한 전 세계적 보안 위협의 맥락을 파악해야 한다. 업비트 해킹은 우발적 범죄가 아닌, 치밀하게 계산된 **APT(Advanced Persistent Threat)** 공격의 일환으로 분석된다.

### 2.1. 라자루스(Lazarus)의 귀환과 타임라인
북한 정찰총국 산하 해킹 조직인 라자루스는 가상자산 거래소를 '국가 자금 조달 창구'로 활용해 왔다. 그들의 공격 패턴은 반복적이며, 규모는 점차 대형화되고 있다.

> **[주요 타임라인 및 피해 규모]**
> * **2019년 11월:** **업비트 이더리움 탈취**
>   * 피해액: 580억 원 (34.2만 ETH)
>   * 특징: 핫월렛 키 직접 탈취, 내부자 소행 의심을 가장한 외부 침투.
> * **2025년 02월:** **바이비트(Bybit) 해킹 (역대 최대)**
>   * 피해액: **약 2조 1,800억 원 (15억 달러)**
>   * 특징: FBI 최우선 수배 명단 등재, 믹서(Mixer)를 통한 초고속 자금 세탁.
> * **2025년 11월:** **업비트 솔라나 탈취 (금번 사고)**
>   * 피해액: 455억 원
>   * 특징: 고속 트랜잭션 체인(Solana)을 타깃으로 하여 대응 시간 무력화.

### 2.2. 공격 전략: 성동격서 (Diversion)
보안 전문가들은 **쿠팡 사태와 업비트 해킹의 시기적 중첩**에 주목한다.
대형 이커머스의 개인정보 유출로 사회적 이목이 쏠리고 KISA 및 보안 인력이 대응에 급급한 틈을 타, 진짜 목표인 금융 자산을 탈취하는 **성동격서(聲東擊西)** 전략일 가능성이 제기된다.

---

## 3. Case I. 업비트 사태: 핫월렛과 속도의 딜레마

### 3.1. 기술적 원인: 핫월렛(Hot Wallet)의 구조적 한계
업비트는 고객의 빠른 입출금 지원을 위해 일정 비율의 자산을 **핫월렛(인터넷에 연결된 지갑)**에 보관한다.
해커의 목표는 명확했다. 콜드월렛(Offline)은 뚫을 수 없으니, 24시간 온라인 상태인 핫월렛 서버의 **개인키(Private Key)** 또는 **서명 모듈(Signing Module)**을 장악하는 것이다.

$$ \text{Security Risk} \propto \frac{\text{Connectivity} \times \text{Asset Value}}{\text{Access Control}} $$

### 3.2. 솔라나(Solana)의 특수성과 대응 실패
이번 공격 대상이 이더리움이 아닌 **솔라나**였다는 점은 기술적으로 큰 의미를 갖는다.
* **이더리움/비트코인:** 트랜잭션 생성 후 블록 확정(Confirmation)까지 수분이 소요되어, 거래소가 이상 징후 감지 시 전파를 차단할 골든타임이 존재한다.
* **솔라나:** **PoH(Proof of History)** 알고리즘 기반으로 초당 수천 건(TPS)을 처리하며, 수초 내에 완결성(Finality)을 갖는다.

해커는 이 '속도'를 역이용했다. FDS(이상거래탐지시스템)가 경보를 울리기도 전에 자산은 이미 거래소 지갑을 떠나 믹서(Mixer)로 흩어졌다.

### 3.3. MPC(Multi-Party Computation)의 부재 혹은 무력화
현대적인 커스터디 보안의 핵심은 키를 쪼개서 보관하는 **MPC** 기술이다.
* **시나리오 A:** 편의성을 위해 핫월렛에 MPC를 적용하지 않고 **단일 키(Single Key)**로 운영했다. (아키텍처 결함)
* **시나리오 B:** MPC를 적용했으나, 키 쉐어(Key Share)가 보관된 서버들이 **동일한 네트워크 존(Zone)**에 있어 동시에 장악당했다. (망분리 실패)

---

## 4. Case II. 쿠팡 사태: BOLA와 신뢰의 붕괴

업비트가 '외부의 적'에 의해 무너졌다면, 쿠팡은 '내부의 허점'으로 인해 무너졌다.

### 4.1. 사고 개요
사용자가 '마이페이지'에 접속했을 때, 세션이 꼬이거나 권한 검증이 누락되어 타인의 이름, 주소, 주문 내역이 노출되었다. 이는 **애플리케이션 계층(L7)**의 로직 오류다.

### 4.2. 핵심 원인: BOLA (Broken Object Level Authorization)
가장 유력한 원인은 OWASP API Security Top 1인 **BOLA(객체 수준 권한 부여 실패)**다. 일명 **IDOR**라고도 불린다.

MSA(Microservices Architecture) 환경에서 API Gateway가 토큰 검증(Authentication)은 수행했으나, 개별 마이크로서비스가 **리소스 소유권 검증(Authorization)**을 누락했을 때 발생한다.

#### [Vulnerable Code Pattern]
```java
// ❌ 취약한 코드: 주문 ID만 있으면 누구나 조회 가능
@GetMapping("/orders/{id}")
public Order getOrder(@PathVariable Long id) {
    return orderRepository.findById(id); // 소유자 검증 없음
}
```

#### [Secure Code Pattern]
```java
// ✅ 안전한 코드: 요청자와 주문 소유자 일치 여부 확인
@GetMapping("/orders/{id}")
public Order getOrder(@PathVariable Long id, @AuthUser User user) {
    Order order = orderRepository.findById(id);
    if (!order.getOwnerId().equals(user.getId())) {
        throw new AccessDeniedException("접근 권한이 없습니다."); // 403 Forbidden
    }
    return order;
}
```

```mermaid
sequenceDiagram
    participant Attacker
    participant API_GW as API Gateway
    participant OrderService as 주문 서비스
    participant DB

    Note over Attacker: 정상 로그인 (User A)
    Attacker->>API_GW: GET /orders/999 (User B의 주문)
    API_GW->>API_GW: JWT 검증 (인증 통과)
    API_GW->>OrderService: 요청 전달
    
    rect rgb(255, 200, 200)
    Note right of OrderService: ❌ 소유권 검증 로직 누락 (BOLA)
    end
    
    OrderService->>DB: SELECT * FROM orders WHERE id=999
    DB-->>OrderService: User B 데이터 반환
    OrderService-->>Attacker: 200 OK (정보 유출)
```

---

## 5. 엔지니어링 제언 (Mitigation & Proposal)

2025년의 보안 대란은 우리에게 명확한 과제를 남겼다. 편의성과 속도를 위해 보안 원칙을 우회한 '기술 부채'가 '보안 파산'으로 돌아온 것이다.

### 5.1. [Infrastructure] Zero Trust & MPC
* **Trust No One:** "내부망이니 안전하다"는 전제를 폐기해야 한다. 모든 서버 간 통신은 **mTLS(Mutual TLS)**로 상호 인증되어야 하며, 데이터 접근 시 맥락(Context) 기반의 검증이 필요하다.
* **MPC Mandatory:** 핫월렛의 개인키는 절대 단일 서버의 메모리에 로드되어서는 안 된다. $N$개의 키 조각 중 $M$개가 승인해야 서명이 생성되는 **Threshold Signature** 방식이 강제되어야 한다.

### 5.2. [Application] Shift Left Security
* **Automated DAST:** 쿠팡 사태와 같은 BOLA 취약점은 배포 전 **동적 애플리케이션 보안 테스팅(DAST)** 도구를 통해 충분히 탐지할 수 있다. 보안 검수가 병목이 아닌 파이프라인의 일부가 되는 **DevSecOps**가 정착되어야 한다.
* **Session Isolation:** 캐싱 서버(Redis, CDN) 설정 시 개인화 정보(PII)가 포함된 응답 헤더(`Cache-Control: private`) 관리를 엄격히 하여 세션 충돌을 방지해야 한다.

### 5.3. [Governance] 법적 책임의 현실화
* **징벌적 손해배상:** 기업이 보안 투자를 '비용'이 아닌 '생존 전략'으로 인식하게 하려면, 사고 발생 시 복구 불가능할 수준의 과징금(GDPR 수준) 부과가 필요하다.

## 6. 맺음말 (Conclusion)

쿠팡의 데이터는 다시 수집하면 되지만, 무너진 신뢰는 복구할 수 없다. 업비트의 탈취된 자산은 보상하면 되지만, 뚫린 보안 아키텍처는 보상으로 메워지지 않는다.

9년 차 엔지니어로서, 이번 사태를 통해 **"보안은 기능(Feature)이 아니라 태도(Attitude)"**임을 다시금 확인한다. 화려한 신기술 도입 이전에, 가장 기본적인 권한 검증과 키 관리 원칙을 지키는 것이야말로 최고의 보안 전략이다.
